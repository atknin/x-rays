{% extends "general/index_old.html" %}
  {% block title %}
  <title>Дифракция</title>
  {% load static %}
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script src="{% static "konva/konva.min.js"%}" ></script>
  <script src="{% static "fabric/fabric.min.js"%}" ></script>



  <link href="{% static "diffraction/css.css" %}" rel="stylesheet">
  <style type="text/css">
    .loader {
      background-image: url('http://smallenvelop.com/wp-content/uploads/2014/08/Preloader_8.gif');
      background-repeat: no-repeat;
      background-position: 50% 50%;
      background-size: 20px 80%;
      color: transparent;
      background-color: transparent;
    }

    .settings{
      margin-top: 30px;
      margin: 20px;

    }


    .panels{
        margin-top: 30px;
        margin-left: 5px;
        border: 1px solid #eee;
    }
    .error {
        border-color: #d9534f !important;
      }
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        /* display: none; <- Crashes Chrome on hover */
        -webkit-appearance: none;
        margin: 0; /* <-- Apparently some margin are still there even though it's hidden */
    }
  </style>

  {% endblock %}

  {% block content %}
    <input type='hidden' id='abracadabraa' value="{{ csrf_token }}" />

    <div class="row" style="margin-top: 50px;" id = "div_choose_howmanycrystals">


   <!-- Без кристаллов -->
    <div class="row" style="background-color: #FAFAFA; height: 360px; margin-top: 40px;" id = "div_zero_crystal">

      <div class="col-md-7" style="margin-left: 20px;">
        <canvas class = 'panels' width=800 height=300 id="fabric"></canvas>

        <div style="display: none;">
          <img src="{% static 'diffraction/img/detector.png' %}" id="detector" >
          <img src="{% static 'diffraction/img/source.png' %}" id="source">
          <img src="{% static 'diffraction/img/sample.png' %}" id="sample" >
          <img src="{% static 'diffraction/img/slit.png' %}" id="slit" >
        </div>

      </div>

      <div class="col-md-4" style="margin-left: 20px;">
        <div class="panels" style="height: 300px; background-color: white;">

<!-- ИСТОЧНИК -->
          <div class="row settings" id="div_settings_source">
            <span class="label label-primary">Параметры источника</span>
              <div class="form-group">
                <label>Анод:</label>
                <select class="form-control" name = 'Источник'  id ='id_source' size="6">
                {%for source in anod%}
                  <option value="{{source.id}}"><small>{{source.name}}</small></option>
                {% endfor %}
                </select>
              </div>
              <div class="form-group">
                <label>Полуширина излучающего пятная, расходимость источника</label>
                <div class="col-md-6 ">
                  <div class="input-group ">
                    <input class="form-control" type="number" name = 'Расходимость источника' value = 0.5 id="source_divergence_mmetr" disabled>
                  <div class="input-group-addon">mm</div>
                  </div>
                </div>
                <div class="col-md-6">
                <div class="input-group">
                  <input class="form-control" type="number" name = 'Расходимость источника' value="600" id="source_divergence_arc" >
                  <div class="input-group-addon">arcsec</div>
                  </div>
                </div>
              </div>
            </div>
<!-- // ИСТОЧНИК -->
<!-- ЩЕЛЬ 1 -->
            <div class="row settings" id="div_settings_slit_1">
              <span class="label label-primary">Параметры щели №1</span>
              <div class="form-group">
                <label>расстояние до источника</label>
                  <div class="input-group ">
                    <input class="form-control" type="number" name = 'Первая щель. Положение' value = 0.54 id="input_l_slit1">
                  <div class="input-group-addon">m</div>
                  </div>
                </div>
                <div class="form-group">
                <label>Размер щели</label>
                  <div class="input-group ">
                    <input class="form-control" type="number" name = 'Первая щель. Ширина' value = 0.02 id="input_size_slit1">
                  <div class="input-group-addon">mm</div>
                  </div>
                </div>
            </div>
<!-- // ЩЕЛЬ 1 -->

<!-- ЩЕЛЬ 2 -->
            <div class="row settings" id="div_settings_slit_2">
              <span class="label label-primary">Параметры щели №2</span>
              <div class="form-group">
                <label>расстояние до источника</label>
                  <div class="input-group ">
                    <input class="form-control" type="number" name = 'Вторая щель. Положение' value = 0.99 id="input_l_slit2">
                  <div class="input-group-addon">m</div>
                  </div>
                </div>
                <div class="form-group">
                <label>Размер щели</label>
                  <div class="input-group ">
                    <input class="form-control" type="number" name = 'Вторая щель. Ширина' value = 0.02 id="input_size_slit2">
                  <div class="input-group-addon">mm</div>
                  </div>
                </div>
            </div>
<!-- // ЩЕЛЬ 2 -->
 <!-- настроить детектор -->
              <div class="row settings" id="div_settings_detector" >
                <div style="margin-bottom: 20px"><span class="label label-primary">Параметры детектора</span></div>
                отсутсвуют
              </div>
<!-- / настроить детектор -->
          <p class="lead" id = 'sign_settings' style="margin: 30px;" >НАСТРОЙКА</p>

        </div>
      </div>
    </div>

    <div class="row">
      <hr>
      {% if user.is_authenticated %}
      <div class="col-md-4">
        <div class="row" >
          <div class="alert alert-danger" style="margin-left: 40px;"  role="alert" id='id_alert_message'>
          </div>
        </div>
            <div class="row" style="margin-left: 50px;">
              <p class="lead"> Параметры расчета:</p>
                <div class="row">
                  <div class="form-group">
                    <label for="step_detail">коэффициент детализации сетки  >= 0.4 </label>
                    <input type="number" style="width: 30%;" class="form-control input-sm" id="step_detail" placeholder="1" value="1" name="коэффициент детализации сетки">
                  </div>
                </div>


            </div>
            <div class="input-group" style="margin: 40px;" id = ''>
              <span class="input-group-btn">
                <button type="button" id = "compute" class="btn btn-success">Рассчитать</button>
                <button type="button" id = "new_compute"  class="btn btn-default">new</button>
              </span>
              <input type="email" class="form-control" id="id_email" placeholder="Email" value = "{{user.email}}">
            </div><!-- /input-group -->
            <div id="loader_addon" style="width: 35px; height: 35px; background-color: transparent; float: right;"></div>
      </div>

      <div class="col-md-8">
        <div class="col-md-2">
          <div >
            <input type="text" class="form-control input-sm" id="lamba_end" placeholder="1" value="ka2+d30%" disabled>
          </div>
          <div style="margin-top: 140px;">
            <input type="text" class="form-control input-sm" id="lamba_start" placeholder="1" value="ka1-d30%" disabled>
          </div>

        </div>
        <div class="col-md-4">
          <div class="row">
            <img style="height: 200px;" src="{% static 'diffraction/img/calc_examp.png'%}">
          </div>
          <div class="row">
            <div class="col-md-6">
              <input type="number" style="width: 70px;" class="form-control input-sm" id="teta_start" placeholder="1" value="-80" name="Угол начальной отстройки - Тета">
            </div>
            <div class="col-md-6">
              <input type="number" style="margin-left: 50px;  width: 70px;" class="form-control input-sm" id="teta_end" placeholder="1" value="80" name="Угол конечной отстройки - Тета">
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <p class="lead"> дополнительно</p>
            <!-- справа -->
            <label>Компьютер:</label>
            <select class="form-control" name = 'Компьютер'  id ='id_pc' size="6">
              {%for PK in computer_online}

                {%if PK.get_time_diff == 'Yes'%}
                  <option value="{{PK.id}}"><small>{{PK.name}}</small></option>
                {%else%}
                {%endif%}

              {%endfor%}
            </select>
        </div>
      </div>
      {% else %}
      <span class="label label-danger">Только зарегистрированным пользователям</span>
      {% endif %}
    </div>




    <!-- Без кристаллов скрипт-->
    <script src="{% static "diffraction/js/zero_crystal.js"%}" > </script>

{% endblock %}
